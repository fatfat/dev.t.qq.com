var common={getMsgByRet:function(A){return{"-201":"对不起，请求参数错误！","-202":"请求被拒绝，请稍后再试！","-400":'登录信息已丢失，请 <a href="javascript:;" onclick="common.showLoginWin()">重新登录</a> ！',"-401":'您还未注册开发者！<a href="/developer/add">点击此处注册成为开发者</a>',"-402":'你的电子邮箱尚未通过验证，不能完成此操作！<a href="/developer/checkemail/">查看详情</a>'}[A]||false},"setCookie":function(H,D,A){if(typeof D!="undefined"){A=A||{};if(D===null){D="";A.expires=-1}var G="";if(A.expires&&(typeof A.expires=="number"||A.expires.toUTCString)){var B;if(typeof A.expires=="number"){B=new Date();B.setTime(B.getTime()+(A.expires*24*60*60*1000))}else{B=A.expires}G="; expires="+B.toUTCString()}var K=A.path?"; path="+(A.path):"";var C=A.domain?"; domain="+(A.domain):"";var I=A.secure?"; secure":"";document.cookie=[H,"=",encodeURIComponent(D),G,K,C,I].join("")}else{var F=null;if(document.cookie&&document.cookie!=""){var L=document.cookie.split(";");for(var J=0;J<L.length;J++){var E=jQuery.trim(L[J]);if(E.substring(0,H.length+1)==(H+"=")){F=decodeURIComponent(E.substring(H.length+1));break}}}return F}},"store":(function(){var B={},E=window,A=E.document,F="localStorage",D="globalStorage",C;B.set=function(I,H){};B.get=function(H){};B.remove=function(H){};B.clear=function(){};B.getItems=function(){};if(F in E&&E[F]){C=E[F];B.set=function(H,I){C.setItem(H,I)};B.get=function(H){return C.getItem(H)};B.remove=function(H){C.removeItem(H)};B.clear=function(){C.clear()};B.getItems=function(){var H={};for(var I in C){H[I]=C[I]}return H}}else{if(D in E&&E[D]){C=E[D][E.location.hostname];B.set=function(H,I){C[H]=I};B.get=function(H){return C[H]&&C[H].value};B.remove=function(H){delete C[H]};B.clear=function(){for(var H in C){delete C[H]}};B.getItems=function(){var H={};for(var I in C){H[I]=C[I]}return H}}else{if(A.documentElement.addBehavior){function G(){if(C){return C}C=A.body.appendChild(A.createElement("div"));C.style.display="none";C.addBehavior("#default#userData");C.load(F);return C}B.set=function(H,K){var I=G(),J=I.getAttribute("sessionKey")||"";I.setAttribute(H,K);if(J.search(new RegExp("\\b"+H+"\\b"))===-1){I.setAttribute("sessionKey",J.split("|").concat(H).join("|"))}I.save(F)};B.get=function(H){var I=G();return I.getAttribute(H)};B.remove=function(H){var I=G();I.removeAttribute(H);I.save(F)};B.clear=function(){var H=G();var J=H.XMLDocument.documentElement.attributes;H.load(F);for(var I=0,K;K=J[I];I++){H.removeAttribute(K.name)}H.save(F)}}}}return B})(),"showLoginWin":function(A){loginWin.close();setTimeout(function(){loginWin.showBox(500,300,A||encodeURIComponent(location.href),"用户登录")},100);return false},"checkuserLogin":function(A){hdlogin=window.hdlogin||false;A=A||encodeURIComponent(location.href);if(hdlogin){return true}else{common.showLoginWin(A)}return false},"loginOut":function(){common.setCookie("uin",null,{domain:"qq.com",path:"/"});common.setCookie("skey",null,{domain:"qq.com",path:"/"});common.setCookie("luin",null,{domain:"qq.com",path:"/"});common.setCookie("lskey",null,{domain:"qq.com",path:"/"});location.reload();return false}};var moduleObj={};(function(A){A.fn.moduleBox=function(D){D=D||{};var B={"width":D.width||450,"height":D.height||320,"title":D.title||"提示信息","text":D.text||"","closeBtn":D.closeBtn||""},C={};C.initModuleBox=function(){var E=A('<div class="modulebox" style="position:fixed;top:0;left:0;width:100%;height:100%;z-index:99999;text-align:left;_ position:absolute;_ top:expression(eval(document.documentElement.scrollTop)); _ height:expression(eval(document.documentElement.clientHeight));display:none;"><iframe width="100%" height="100%" frameborder="0" style="opacity:0;filter:alpha(opacity=0);z-index:1;position:absolute;top:0;left:0;"></iframe><div style="position:absolute;top:0;left:0;z-index:2;background:#000;width:100%;height:100%;opacity:0.2;filter:alpha(opacity=10);"></div>	<div class="modulebox_win" style="position:absolute;z-index:3;top:50%;left:50%;margin:'+(-B["height"]/2)+"px 0 0 "+(-B["width"]/2)+"px;width:"+B["width"]+"px;height:"+B["height"]+'px;">		<a href="javascript:;" class="modulebox_close closewin" title="关闭"></a>		<h2 class="modulebox_title" style="margin:0;padding:0;">'+B["title"]+'</h2>		<div class="modulebox_content" style="height:'+(B["height"]-41)+'px">'+B["text"]+"</div>	</div></div>").appendTo(A("body"));E.find(".closewin").bind("click",function(){E.hide()});return{"working":false,"waiting":[],"titlebar":E.find(".modulebox_title"),"win":E.find(".modulebox_win"),"contentarea":E.find(".modulebox_content"),"closebtn":E.find(".modulebox_close"),"close":function(H){this.working=false;this.contentarea.html("");E.hide();(H||function(){})();if(this.waiting.length>0){var F=this,G=F.waiting.shift();setTimeout(function(){F[G["_show"]||"show"].call(F,G,H)},100)}},"show":function(F){if(this.working){this.waiting.push(F);return}if(F){if(F.title){this.titlebar.html(F.title)}if(F.text){this.contentarea.html(F.text)}if(F.width){this.win.css({"width":F.width,"margin-left":-F.width/2})}if(F.height){this.win.css({"height":F.height,"margin-top":-F.height/2});this.contentarea.css({"height":F.height-41})}}if(!E.is(":visible")){E.show();this.working=true}}}};return C.initModuleBox()}})(jQuery);this.init=function(){$("#logoutBtn").bind("click",common.loginOut);$("#loginBtn,#loginBtn2").click(function(){common.showLoginWin();return false});$("#developmentbtn").click(function(){return(!!checkuserLogin(encodeURIComponent("http://"+location.host.replace(/\bwiki\b\./,"dev.")+"/development/")))});$("#loginBtn_body").click(function(){loginWin.showBox(335,380);return false});$(".boxbg").click(function(){loginWin.hideBox()});$(".login_div_header").find(".closeBtn").click(function(){loginWin.hideBox()});window.loginWin=$.fn.moduleBox({"width":500,"height":400,"title":"","text":""});window.loginWin.closebtn.bind("click",function(){loginWin.close.call(loginWin)});window.loginWin.showBox=function(C,D,A,B){A="http://ui.ptlogin2.qq.com/cgi-bin/login?appid=46000101&s_url="+A+"&f_url=loginerroralert&style=0&link_target=blank&target=blank&hide_title_bar=1&dummy=1&bgcolor=ffffff";this.show({"width":C,"height":D,"title":B||"对不起，您还未登录","text":'<div id="login_div" style="*display:inline;zoom:1;padding-top:20px;width:100%;height:100%;"><iframe src="'+A+'" width="100%" height="100%" frameborder="0" scrolling="no" marginwidth="0" marginheight="0"></iframe></div>'})};window.loginWin.alert=function(A,B){var C={"_show":"alert","title":"提示","text":"","width":420,"height":150,"ok_text":"确定","ok_class":"devSubmit closeBtn"};if(typeof A=="string"){C.text=A}else{if(typeof A=="object"){C.title=A.title||C.title;C.text=A.text||C.text;C.width=A.width||C.width;C.height=A.height||C.height;C.ok_text=A.ok_text||C.ok_text;C.ok_class=A.ok_class||C.ok_class}}(typeof(A&&A._show)==="undefined")&&(C.text="<br/>"+C.text+'<center><input type="button" class="'+C.ok_class+'" value="'+C.ok_text+'"/></center>');loginWin.show.call(loginWin,C);loginWin.contentarea.find(".closeBtn").bind("click",function(){loginWin.close.call(loginWin,B)})};window.loginWin.showImg=function(A,B){var C={"_show":"alert","title":"提示","text":"","width":500,"height":650};if(typeof A=="string"){C.text=A}else{if(typeof A=="object"){C.title=A.title||C.title;C.text=A.text||C.text;C.width=A.width||C.width;C.height=A.height||C.height}}(typeof(A&&A._show)==="undefined")&&(C.text='<div style="overflow:auto;text-align:center;"><img src=\''+C.text+"' /></div>");loginWin.width=C.width;loginWin.height=C.height;loginWin.show.call(loginWin,C)};window.loginWin.confirm=function(G,D,E){var C={"width":420,"height":180,"text":"","title":"提示","ok_text":"确定","cancel_text":"取消"},F='<div style="text-align:center;margin:0 20px;">		 		  <div style="text-align:left;display:inline-block;* display:inline;zoom:1;margin:22px auto 14px;word-wrap:break-word;word-break:break-all;">		 			#text#		 		  </div>	 		</div>	 		<div align="center">	 		  	<a href="javascript:;" class="devSubmit sure_btn">#ok_text#</a>	 		  	<a href="javascript:;" class="devCancel close_btn">#cancel_text#</a>	 		</div>',B=loginWin,A=B.contentarea;if(typeof(G)==="string"){G=F.replace("##",G);C=$.extend(C,{"text":G})}else{if(typeof(G)==="object"){G.text=F.replace(/#(\S+)?#/g,function(){return G[arguments[1]]||("#"+arguments[1]+"#")});$.extend(C,G)}}this.show(C);A.find(".sure_btn").bind("click",function(){B.close();D&&D()});A.find(".close_btn").bind("click",function(){B.close();E&&E()});this.closebtn.unbind("click").bind("click",function(){window.location.reload()})}};this.util=this.util||{};util.setLoginInfo=function(){$.ajax({"dataType":"json","type":"post","url":"/pipes/interfaceserver","data":{"action":"get_login_info"},"success":function(A){if(A.ret!=0&&A.msg){loginWin.alert("<center>"+msg+"</center>");return}var B=['<%if (hdlogin != "false" ) {%>','<div class="menu">','<a class="login_name" href="javascript:;" title="<%=nick?nick:uin%>"><%=nick?nick:uin%><em></em></a>','<i class="nav_arrow"></i>',"</div>",'<ul class="childMenu userNav_sub">','<li class="sub_item"><a class="sub_item_link sub_active" href="/development/developer/">编辑开发者信息</a></li>','<li class="sub_item"><a class="sub_item_link" href="javascript:;" id="logoutBtn">退出</a></li>',"</ul>","<%} else {%>",'<a title="点击此处登录" class="login_name" href="javascript:void(0);" id="loginBtn" hidefocus>登录</a>',"<%}%>",].join("");$("#login_status").html(tmpl(B,A.data));if(A.data.hdlogin&&A.data.hdlogin!=false&&A.data.hdlogin!="false"){A.data.hdlogin=true;$("#logoutBtn").bind("click",common.loginOut)}else{A.data.hdlogin=false;$("#loginBtn").click(function(){common.showLoginWin();return false})}global_obj.data.userInfo.hdlogin=userInfo.hdlogin=hdlogin=A.data.hdlogin}})};var showLoginWin=common.showLoginWin,cookie=common.setCookie,checkuserLogin=common.checkuserLogin,openAppAfterLogin=function(A){return(!!checkuserLogin(A.attr("href")))},ptlogin2_onResize=function(A,B){console.log([A,B].join(","));$(".modulebox_content").removeAttr("style").parent().width(A).css("margin-left",-Math.ceil(A/2)).end().height(B+40).parent().height(B+75);$("#login_div").height(B)};$(function(){$("body").mouseover(function(B){var A=$("#login_status"),C=B.target;if(window.hdlogin&&window.hdlogin!="false"&&window.hdlogin!=false){if($.contains(A[0],C)||A[0]===C){A.addClass("menuContainer")}else{A.removeClass("menuContainer")}}})});