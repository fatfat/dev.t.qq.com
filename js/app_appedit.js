var OPEN_VALIDATOR;OPEN_VALIDATOR={apptypeName:"应用",working:0,checkip:function(B){var A=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;var C=B.match(A);if(C===null){return"非法的IP地址段！"}else{return true}},isempty:function(){return true},appsupport:function(){return true},appsupportIsEmpty:function(B){var A=B.attr("data-error"),D=B.attr("data-terminal");var C=$("#app_support_list").find("input[name='check_"+D+"']:checked").size();return C>0},tname:function(A){if(A&&!(/^[a-zA-Z][a-zA-Z0-9_\-]{3,19}$/g.test(A))){return"##输入有误"}return true},appweibo:function(A,E){var B=E.attr("data-error");A=A.replace(/\s/g,"");E.val(A);if(A&&!(/^[a-zA-Z][a-zA-Z0-9_\-]{0,19}$/g.test(A))){return B+"输入有误"}var D=E.attr("data-only");if(D){if(D==="true"){return true}else{return"该"+B+"不存在"}}else{var C=E.attr("data-default");if(C){if(A==C){return true}else{return 1}}else{return 1}}return true},telnum:function(A){if(new RegExp(/^([0-9]|[-])+$/g).test(A)){return true}else{return"##格式错误"}},link:function(A){var B="^((news|telnet|nttp|file|http|ftp|https)://)(([-A-Za-z0-9_]+(\\.[-A-Za-z0-9_]+)*(\\.[-A-Za-z]{2,6}))|([0-9]{1,3}(\\.[0-9]{1,3}){3}))(:[0-9]*)?(/[-A-Za-z0-9_$\\.+!*(),;:@&=?/~#%']*)*";var C=new RegExp(B);if(/["'<>]/g.test(A)){return"##不能含有'\"<>"}else{if(C.test(A)){return true}else{return"##格式错误"}}},appstorelink:function(A){var B="^((https|http)://itunes.apple.com)(:[0-9]*)?(/[-A-Za-z0-9_$\\.+!*(),;:@&=?/~#%']*)*";var C=new RegExp(B);if(/["'<>]/g.test(A)){return"##不能含有'\"<>"}else{if(C.test(A)){return true}else{return"请填写苹果官方市场下载地址"}}},androidlink:function(A){var B="^(https://play.google.com)(:[0-9]*)?(/[-A-Za-z0-9_$\\.+!*(),;:@&=?/~#%']*)*";var C=new RegExp(B);if(A){if(/["'<>]/g.test(A)){return"##不能含有'\"<>"}else{if(C.test(A)){return true}else{return"##格式错误"}}}else{return true}},applink:function(A){if(A){return OPEN_VALIDATOR.link(A)}else{return true}},appapk:function(A){if(A){return true}else{return"请上传##"}},email:function(A){if(new RegExp(/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/).test(A)){return true}else{return"##格式错误"}},appname:function(A,E){A=A.replace(/^\s+|\s$/g,"");E.val(A);var F=A.match(/[^A-Za-z0-9（）()\u4e00-\u9fa5]+/g);if(A&&F){return"##不能含有非法字符"+F.join("")}if(A.replace(/[^\x00-\xff]/g,"tx").length<=14){var C=E.attr("data-only");if(C){if(C==="true"){return true}else{var D=E.parent().next().text();if(D!=""){return D}else{return"此##已被注册"}}}else{var B=E.attr("data-default");if(B){if(A==B){return true}else{return 1}}else{return 1}}}else{return"##不能超过7个汉字"}},appnameCheck:function(A,E){var B=E.attr("data-error"),C=E.attr("data-default"),G=E.attr("data-rule"),D={"appname":"/pipes/interfaceserver","compname":"/pipes/interfaceserver"},F={"appname":{"action":"common_query","business_type":"ajax_checkname","appname":A},"compname":{"action":"common_query","business_type":"ajax_checkcompname","comp_name":encodeURIComponent(A),"comp_type":window.comp_type}};F[G]["random"]=+new Date();if(C!=A){showmsg(1,E,"正在验证"+B+"是否重复...");$.ajax({"type":"get","dataType":"json","url":D[G],"data":F[G],"success":function(I){var H=E.attr("data-working")|0;if(I.error==0){E.attr("data-only",true);showmsg(true,E,"");if(H==2){loginWin.close();setTimeout(function(){$("form input[type='submit']").trigger("click")},500)}E.removeAttr("data-working")}else{E.attr("data-only",false);showmsg(false,E,I.msg);E.removeAttr("data-working");if(H==2){loginWin.close();loginWin.alert("<center>"+I.msg+"</center>")}return false}},"error":function(){E.attr("data-only","false");E.removeAttr("data-working");setTimeout(function(){showmsg(false,E,"验证失败！请检查网络")},100);return false}});return true}else{E.attr("data-only","true");E.removeAttr("data-working");return true}},appdes:function(A,B){A=$.trim(A);B.val(A);if(A.length>140){return"##不能超过140个汉字"}else{if(A.length<30){return"##不能少于30个汉字"}else{return true}}},wappdes:function(A,B){A=$.trim(A);B.val(A);if(A.length<30){return"##不能少于30个汉字"}else{return true}},apphight:function(A,B){A=$.trim(A);$("#app_hight").val(A);if(new RegExp(/^[1-9][0-9]*$/).test(A)){if(A>1200||A<700){return"##必须在700—1200之间"}else{return true}}else{return"##必须是正整数"}},appname_only:true,companyname:function(A){if(A.length<=40){return true}if(A.length>40){return"##不能超过40个字符"}},comaddress:function(A){if(A.length<=100){return true}if(A.length>100){return"##不能超过100个字符"}},comperson:function(A){if(A.length<=20){return true}if(A.length>20){return"##不能超过20个字符"}},app_class_main:function(A){if(A==-1||A<=0){return"请选择分类"}return true},app_class_child:function(A){var B=$("input[name='app_type']").val();if(B!=4){return true}if(A==-1||A<=0){return"请选择分类"}return true},appweiboCheck:function(A,E){var B=E.attr("data-error"),C=E.attr("data-default"),G=E.attr("data-rule"),D="/pipes/interfaceserver",F={"name":A,"action":"common_query","business_type":"ajax_checkwb"};if(C!=A){showmsg(1,E,"正在验证"+B);$.ajax({"type":"get","dataType":"json","url":D,"data":F,"success":function(J){var H=E.attr("data-working")|0,K=+J.ret,I=common.getMsgByRet(K);if(I){E.attr("data-only",false);showmsg(false,E,I);E.removeAttr("data-working");return}if(K===0){E.attr("data-only",true);showmsg(true,E,"");if(H==2){setTimeout(function(){$("form input[type='submit']").trigger("click")},500)}E.removeAttr("data-working")}else{E.attr("data-only",false);E.attr("error-flag",0);showmsg(false,E,"该"+B+"不存在");E.removeAttr("data-working");if(H==2){loginWin.alert("<center>该"+B+"不存在</center>")}return false}},"error":function(){E.attr("data-only","false");setTimeout(function(){showmsg(false,E,"验证失败！请检查网络")},100);return false}});return true}else{E.attr("data-only","true");E.removeAttr("data-working");return true}},installSize:function(A,B){A=$.trim(A);B.val(A);if(new RegExp(/^[\d]+\.?[\d]*([Mm][Bb]?)?$/).test(A)){return true}else{return"##格式不正确"}}};OPEN_VALIDATOR.apptypeName=/iweibo/.test(location.pathname)?"组件":(/platform/.test(location.pathname)?"平台":"应用");function getlen(B){var A=0;for(var C=0;C<B.length;C++){if(B.charCodeAt(C)>255){A+=2}else{A++}}return A}function showmsg(F,D,B){var G,C=D.parent(),A=D.parent(".form_input"),E=D.parent(".form_element");if(!F){G='<span class="tip tip_err"><span class="tip_icon"></span>'+B+"</span>"}else{if(true===F){G='<span class="tip tip_ok"><span class="tip_icon"></span></span>'}else{if(1===F){G='<span class="tip tip_waiting"><span class="tip_icon"></span>'+B+"</span>"}else{if(2===F){G='<span class="tip">'+B+"</span>"}}}}if(C.hasClass("form_input")||C.hasClass("form_element")){C.parent().find(".tip").remove();C.after(G);C.parent().find(".inputdes").first().hide()}else{if(C.hasClass("form_button_upload")){C.parent().find(".tip").remove();C.parent().append(G);C.parent().find(".inputdes").first().hide()}else{C.find(".tip").remove();C.append(G)}}}function formSubmit(){if($(".errorTip").length>0){loginWin.show({"title":"更新"+OPEN_VALIDATOR.apptypeName+"信息","width":410,"height":185,"text":'<center><br/><label class="icon_alert"></label> &nbsp;表单中有错误，请修改后再提交 <br/><input type="button" class="devSubmit closeBtn" value="返回修改"/></center>'});loginWin.contentarea.find(".closeBtn").bind("click",function(){loginWin.close()})}else{loginWin.show({"title":"更新"+OPEN_VALIDATOR.apptypeName+"信息","width":410,"height":120,"text":"<div style='text-align:center;line-height:59px;'>数据提交中，请勿操作或关闭浏览器窗口</div>"})}}$(function(){$('<div class="tooltip" id="tooltip"><div class="toolangle"><span class="a1">◆</span><span class="a2">◆</span></div><div class="tooltext"></div></div>').appendTo($("body"));window.tooltip={"timer":null,"show":function(B,D,A){var C=D.offset();$("#tooltip").show().css({"left":C.left,"top":C.top+D.height()}).find(".tooltext").html(B);D.get(0).scrollIntoView(true);clearTimeout(tooltip.timer);if(A){tooltip.timer=setTimeout(function(){$("#tooltip").fadeOut()},A)}}};$("input[type='file']").change(function(){var J=this.files&&this.files[0],P=$(this),C=$(this).parent().find("img")[0],A=$(this).parent().find("img"),I=new Image(),N="",M=P.attr("_size")||500,O=P.hasClass("png_jpg")?2:1,F=O==2?new RegExp(/\.(png|jpeg|jpg)$/i):new RegExp(/\.(png)$/i),B=O==2?new RegExp(/^image\/(png|jpeg)$/i):new RegExp(/^image\/(png)$/i),G=O==2?"jpg/png":"png",D=function(){setTimeout(function(){A.removeAttr("src").attr("src","http://mat1.gtimg.com/app/opent/images/websites/0.gif");P.val("")},100)},L=function(Q){loginWin.alert({"text":'<div style="margin:0 0 0 30px;">由于您的浏览器安全限制，'+Q+'<br/>请将本站( <span style="color:red;font-weight:bold;">'+location.href.slice(0,location.href.indexOf(location.pathname)+1)+'</span> )添加到受信任的站点列表中 <br/>点击此处了解 <a href="http://open.t.qq.com/bbs/forum.php?mod=viewthread&tid=21271" target="_blank">如何将本站添加到受信任的站点列表中？</a></div><div style="color:#090;margin:0 30px;">您也可以使用非IE内核浏览器，如chrome、firefox（Safari暂不支持）</div>',"width":460,"height":200});D()},E=function(){C.src="http://mat1.gtimg.com/app/opent/images/websites/0.gif";var Q=setTimeout(function(){if(+(I.width||"")===0||+(I.height||"")===0){L("无法获取图片大小");P.attr("data-error",N);return}},200);I.onload=function(){if(this.complete){return false}if(F.test(I.src)==false){N="你上传的图片不是有效的"+G+"格式图片";loginWin.alert("<center>"+N+"</center>");P.attr("data-error",N);D();return}else{if(I.fileSize/1024>M){N="文件大小不能超过"+M+"K，请重新选择";loginWin.alert("<center>"+N+"</center>");P.attr("data-error",N);D();return}else{if(A.attr("_width")&&A.attr("_width")){if(+(I.width||"")===0||+(I.height||"")===0){L("无法获取图片大小");P.attr("data-error",N);D();return}else{if(I.width!=A.attr("_width")||I.height!=A.attr("_height")){N="你上传的图片尺寸"+I.width+"×"+I.height+"不符合要求，请选择一张"+A.attr("_width")+"×"+A.attr("_height")+"大小的"+G+"图片";P.attr("data-error",N);N+='<div style="border-top:1px dashed #ccc;margin-top:5px;padding-top:5px;"><strong>如果你的图片尺寸符合要求但仍然看到该提示，你可以：</strong><br/>1、如果你的浏览器是双核浏览器，可以切换到极速模式重新上传<br/>2、如果你的浏览器不是双核浏览器，可以使用其它浏览器，如chrome或firefox</div>';loginWin.alert({"text":'<div style="margin:0 25px;">'+N+"</center>","width":500,"height":215});P.attr("data-error",N);D();return}}}}}C.src=I.src;P.removeAttr("data-error");I.onload=null};I.onerror=function(){N="读取图片失败，浏览器不支持直接读取图片";L("加载图片失败");P.attr("data-error",N);I.onerror=null;D();return};I.src=P[0].value;return},K=function(){N="你的浏览器不支持fileReader，无法预览图片<br/>建议使用firefox或chrome浏览器或升级您当前的浏览器至最新版本";loginWin.alert({"text":"<center>"+N+"</center>","height":170});P.attr("data-error",N);D();return},H=function(){var R=new FileReader(),S=function(T){return function(V){for(var U in T){T[U].src=V.target.result}}},Q=false;R.onload=S([C,I]);R.readAsDataURL(J);S([C]);if(A.attr("_width")&&A.attr("_width")){(function(){var U=arguments.callee,T=arguments[0];if((((I.width||I.height)|0)==0)&&(T<10)){setTimeout(function(){U(++T)},100);return}if((I.width!=A.attr("_width")||I.height!=A.attr("_height"))&&!Q){N="你上传的图片尺寸"+I.width+"×"+I.height+"不符合要求<br/>请选择一张"+A.attr("_width")+"×"+A.attr("_height")+"大小的"+G+"图片";C.src="http://mat1.gtimg.com/app/opent/images/websites/0.gif";loginWin.alert({"text":"<center>"+N+"</center>","height":160});P.attr("data-error",N);D();return}if(!Q){P.removeAttr("data-error",N)}})(0)}if(B.test(J.type)&&(J.fileSize||J.size)/1024<=M){}else{if(B.test(J.type)==false){N="你上传的图片不是有效的"+G+"格式图片";Q=true;loginWin.alert("<center>"+N+"</center>");P.attr("data-error",N);D();return false}else{if((J.fileSize||J.size)/1024>M){N="文件大小不能超过"+M+"K，请重新选择";Q=true;loginWin.alert("<center>"+N+"</center>");P.attr("data-error",N);D();return false}else{P.removeAttr("data-error");return true}}}};if(window.FileReader){return H()}else{if(document.all){return E()}else{return K()}}})});var need_post=false;$(function(){function B(){var H=[];$("input[name='check_app_os']:checked").each(function(){H.push($(this).val())});$("input[name='app_os']").val(H.join("|"));return H}function F(){var H=[];$("input[name='check_app_phone']:checked").each(function(){H.push($(this).val())});$("input[name='app_phone']").val(H.join("|"));return H}function C(){var H=[];$("input[name='check_app_pad']:checked").each(function(){H.push($(this).val())});$("input[name='app_pad']").val(H.join("|"));return H}$("input[name='check_app_os'],input[name='check_app_phone'],input[name='check_app_pad']").change(function(){var H=$(this).attr("name").replace("check_app_","").toLowerCase();var I="";switch(H){case"os":I=B();$("input[name='app_phone']").val("");$("input[name='app_pad']").val("");break;case"phone":I=F();$("input[name='app_os']").val("");$("input[name='app_pad']").val("");break;case"pad":I=C();$("input[name='app_os']").val("");$("input[name='app_phone']").val("");break}$("#app_support").trigger("blur")});$("input#app_name,input#app_url,input#app_down_url,input#app_support,textarea#app_description,input[type=checkbox],input#app_weibo,select#app_class_main,select#app_class_child").change(function(){need_post=1});$("form input[data-rule='appweibo']").change(function(){var I=$(this),J=I.attr("data-rule"),H=I.val();if(J=="appweibo"){if(/^[a-zA-Z][a-zA-Z0-9_\-]{0,19}$/g.test(H)){I.removeAttr("data-only");I.removeAttr("error-flag");I.attr("data-working",1);OPEN_VALIDATOR["appweiboCheck"](H,I)}}});$("form input[type='text'],form textarea").blur(function(){var M,H,L,J,K;M=$(this);H=M.val();L=M.attr("data-rule");J=M.attr("data-error");if((/^link|applink$/.test(L))&&H.length>0&&H.search(/http[s]?:\/\//)==-1){H="http://"+H;M.val(H)}if(OPEN_VALIDATOR.hasOwnProperty(L)&&L){if((!$.trim(H)&&L!="tname"&&L!="applink"&&L!="androidlink")||(H=="请选择"&&L=="appsupport")){J+="不能为空";K=false}else{var I=OPEN_VALIDATOR[L](H,M);if(I&&L=="appsupport"){K=OPEN_VALIDATOR["appsupportIsEmpty"]($(this));J+="不能为空"}else{if(I==undefined){K=false;J=""}else{if(I===true){K=true}else{if(I===1){return}else{K=false;J=I.replace(/##/g,J)}}}}}showmsg(K,M,J)}});$("form input[type='checkbox']").click(function(){var H=$(this).attr("name"),I=$(this).attr("data-rule");if(I=="isempty"){if($(this).parent().find("input[type='checkbox']:checked").size()==0){showmsg(false,$(this),"请至少选择一项")}else{showmsg(true,$(this),"")}}});$("form input[type='submit']").click(function(){var R=this.form,J=$(R).find("input[data-working]");if(J.size()>0){J.attr("data-working",2);return false}var V=$.trim($(this).attr("data-rule")),L=+$("#app_platform").val();if(V=="formauto"){if($(R).hasClass("wirelessappform")&&L===0){loginWin.alert("<center>请至少选择一个平台</center>");return false}if(global_obj.data.app.app_type==3&&$("input[name='check_app_os']:checked").size()==0){loginWin.alert("<center>请至少选择一个应用平台</center>");return false}var K=this.form,U,Y,M,H,O=true,N="",Q=true;if(!OPEN_VALIDATOR.appname_only){Y="此"+OPEN_VALIDATOR.apptypeName+"名称已被注册";loginWin.alert("<center>"+Y+"</center>");return false}$("form input[type='text'],form textarea,select#app_class_main,select#app_class_child,form input[type='file']").each(function(){if($(R).hasClass("wirelessappform")){if((L===1&&$(this).hasClass("android_field"))||(L===2&&$(this).hasClass("iphone_field"))){return}}M=$(this).attr("data-rule");H=$(this).val();Y=$(this).attr("data-error");if(OPEN_VALIDATOR.hasOwnProperty(M)&&M){if((!$.trim(H)&&M!="tname"&&M!="applink"&&M!="androidlink")||(H=="请选择"&&M=="appsupport")){Y+="不能为空";U=false}else{var Z=OPEN_VALIDATOR[M](H,$(this));if(Z&&M=="appsupport"){U=OPEN_VALIDATOR["appsupportIsEmpty"]($(this));Y+="不能为空"}else{if(Z===true){U=true}else{if(Z===1){return}else{U=false;Y=Z.replace(/##/g,Y)}}}}showmsg(U,$(this),Y);if(O&&!U){loginWin.alert("<center>"+Y+"</center>")}O=O&&U}else{if($(this).hasClass("required")){if((!$(this).val()&&!$(this).attr("data-default").replace("NULL",""))||$(this).attr("data-error")){Q=false;str="<center>请上传应用预览图</center>";$(this).prev(".uploadbtn")[0].scrollIntoView(true);if(O){loginWin.alert(str)}tooltip.show(str,$(this).prev(".uploadbtn"),2000);O=O&&Q;return false}}else{if($(this).hasClass("file")){if(O&&$(this).attr("data-error")){$(this).attr("disabled","disabled");return false}}}}});if(!O){return O}if($(R).hasClass("wirelessappform")){var P=$("input[name='appplatform']");if($("input[name='appplatform']:checked").length==0){showmsg(false,$("#iphone_pf"),"请至少选择一个平台");loginWin.alert("<center>请至少选择一个平台</center>");return false}if($("input[name='app_apk']").val()==""&&($("#app_platform").val()==2||$("#app_platform").val()==3)){$("#android_pf")[0].scrollIntoView();var T=$("input[name='app_apk']"),W=$(".form_button_upload"),I=$(".form_element_uploaded_name"),S=$(".form_element_uploaded");S.addClass("none");W.removeClass("none");T.val("").removeAttr("data-default");loginWin.alert("<center>请上传apk安装文件</center>");showmsg(false,T,"请上传apk安装文件");return false}}var X=$("input[name='user_agree']").attr("checked");if(X===undefined){if(O){A(K)}else{return false}}else{if(X==true){if(O){A(K)}else{return false}}else{loginWin.alert("<center>您尚未同意《腾讯微博开放平台开发者服务协议》</center>");return false}}}return false});function A(J){var Q=+$("input[name='app_type']").val(),X=global_obj.data.app.app_status,V=$("input[name='app_url']"),I=$("input[name='icon4']"),R=false,P=global_obj.data.androidinfo?global_obj.data.androidinfo.app_plat_status:"",S=global_obj.data.iphoneinfo?global_obj.data.iphoneinfo.app_plat_status:"",O="";if(Q===1||Q===2||Q===3){if(X===4||X===5||X===8){if(V.val()!=V.attr("data-default")){O="<center>修改"+V.attr("data-error")+"后需再次提交审核，审核通过后才能生效。<br/>是否提交修改资料审核？</center>";R=true}}}else{if(Q===6){var U=$("#wapp_platform").val();if(U==0){if(+X===5&&P!=2&&S!=2){if(V.val()!=V.attr("data-default")||(I.val()!=""&&I.val()!=I.attr("data-default"))){O="<center>修改"+V.attr("data-error")+"或75×75应用图标后需再次提交审核，审核通过后才能生效。<br/>是否提交修改资料审核？</center>";R=true}}}else{if(+X===3&&(P==2||S==2)){var K=null,M=$("input[name='app_platform']").val(),W=$("input[name='app_platform_changed']"),N=0,L=0,H,T;K=M==3?$(".wirelessappform"):(M==2?$("#androidContainer"):$("#iphoneContainer"));K.find("input[type='text'],textarea,input[type='file']").each(function(){H=$(this).val();T=$(this).attr("data-default");if((!$(this).hasClass("file")&&H!=T)||($(this).hasClass("file")&&H!=""&&H!=T)){if($(this).hasClass("iphone_field")){N=1}else{if($(this).hasClass("android_field")){L=1}}if((P==2&&S==2)||(P==2&&S!=2&&$(this).hasClass("android_field"))||(P!=2&&S==2&&$(this).hasClass("iphone_field"))){O="<center>修改平台信息后需再次提交审核，审核通过后才能生效。<br/>是否提交修改资料审核？</center>";R=true}return}});if(N&&L){W.val(3)}else{if(N){W.val(1)}else{if(L){W.val(2)}}}}}}}if(R){loginWin.confirm({"text":O,"width":440,"ok_text":"确定","cancel_text":"取消"},function(){E(J)},function(){loginWin.close()});return false}E(J)}function E(I){if($(I).hasClass("wirelessappform")){var H=+$("#app_platform").val();if(H===1){$(".android_field").each(function(){$(this).val("")})}else{if(H==2){$(".iphone_field").each(function(){$(this).val("")})}}}I.submit();formSubmit()}$("form input[data-rule='appname']").change(function(){var I=$(this),J=I.attr("data-rule"),H=I.val().replace(/\s/g,"");if(/^[A-Za-z0-9（）()\u4e00-\u9fa5]{1,14}$/.test(H)&&H.replace(/^\s+|\s+$/g,"").replace(/[^\x00-\xff]/g,"TX").length<=14){I.removeAttr("data-only");I.attr("data-working",1);OPEN_VALIDATOR["appnameCheck"](H,I)}else{I.removeAttr("data-only")}});$("input[data-rule='link']").keydown(function(H){if(H.keyCode==13){return false}});$("form").keydown(function(H){if(H.keyCode==13){$(this).find("input[type='submit']").trigger("click");return false}});$("form input[type='reset']").click(function(){$(".form_input").next(".errorTip").remove();$(".form_input").next(".currectTip").remove()});var D=$("input[name='app_phone'],input[name='app_pad'],input[name='app_os']").filter("[value ^='']");if(D.size()===0){$("input[name='app_phone']").val("Android");D=$("input[name='app_phone']")}D.each(function(L){var H=$(this).attr("name"),I=$(this).val(),J=$("#app_support").attr("data-terminal")||0;if(I||0){$("#app_support").val($(this).parent("li").find(".form_select_options").find("li:eq("+L+")").text());$("#app_support").attr("data-terminal",H);$("#app_support_list").show();$("#app_support_list").find("input[value='"+I+"']").parent().show().siblings("dd").hide();s=I.split("|");for(var K in s){$("input[name='check_"+H+"']").filter("[value='"+s[K]+"']").attr("checked","checked")}return false}else{$("#app_support").val("请选择").removeAttr("data-terminal")}});$(".tip").remove();var G=function(N){var I=$("#app_online_url").parent(),J=I.find(".form_select_icon"),L=I.find(".form_select_options"),K=I.find("input"),H=0;var M=function(R){var O=[];if(R.length){for(var P=0,Q=R.length;P<Q;P++){O.push("<li>http://"+R[P]+"</li>")}O.push("<li _index='"+P+"'>手动填写</li>")}else{O[0]='<div class="gray">&nbsp;未申请托管地址，<a href="javascript:;" onclick="$(\'#apphost_btn\').trigger(\'click\');return false;">现在去申请</a></div>'}return O.join("")}(N);if(N.length){K.attr("data-rule","link").attr("readonly",true)}else{I.prev(".form_label").find("em").remove()}L.html(M).find("li").mouseover(function(){$(this).parent().find("li").removeClass("active");$(this).addClass("active")}).click(function(O){if($(this).attr("_index")){K.val("").removeAttr("readonly")}else{K.val($(this).html()).attr("readonly",true)}if(typeof(O.button)!="undefined"){K.trigger("blur")}L.hide()}).filter(":eq(0)").addClass("active");K.attr("readonly",true).attr("autoComplete","off").focus(function(){if(K.attr("readonly")){L.show()}}).bind("keydown",function(O){var R=L.find("li.active"),Q=R.index();H=L.find("li").size();if(O.keyCode===9){return true}if(!L.is(":visible")&&K.attr("readonly")){$(this).trigger("focus");return false}switch(O.keyCode){case 40:if(Q+1<H){var P=L.find("li:eq("+(++Q)+")");P.trigger("mouseover");if(P[0].offsetTop-L[0].scrollTop>=L.height()){L[0].scrollTop+=P.height()}}break;case 38:if(Q>0){var P=L.find("li:eq("+(--Q)+")");P.trigger("mouseover");if(P[0].offsetTop<L[0].scrollTop){L[0].scrollTop-=P.height()}}break;case 13:if(K.attr("readonly")){R.trigger("click")}L.hide();break;default:return true}return false}).bind("click",function(){if(!L.is(":visible")&&K.attr("readonly")){L.show()}});J.click(function(){if(!K.attr("disabled")){L.show()}});$("body").bind("click",function(O){if($.contains(I[0],O.target)){return}if(L.is(":visible")){L.hide()}})};if(+$("input[name='app_hosting']:checked").val()===1){if(window.app_status&&(+app_status===2)){$("#app_online_url").attr("readonly",true);$("#app_online_url").parent().prev(".form_label").find("em").remove()}else{$.ajax({"dataType":"json","type":"post","url":"/pipes/interfaceserver","data":{"action":"common_query","uin":global_obj.data.userInfo.hdlogin,"appid":global_obj.data.app.app_id,"business_type":"ajax_getappsitelist"},"success":function(I){var J=+I.ret,H=common.getMsgByRet(J);if(H){loginWin.alert("<center>"+H+"</center>");return}G(I.data||[])}})}}});$("#app_class_child").change(function(){var B=$("#app_class_child");var A=B.val();if(A!=-1){showmsg(true,B,"")}else{showmsg(false,$("#app_class_child"),"应用分类不能为空")}});$("#app_class_main").change(function(){var B=$("#app_class_child");var A=$("#app_class_main").val();if(A!=-1){$.ajax({"dataType":"json","type":"get","url":"/pipes/interfaceserver","data":{"action":"common_query","business_type":"getapptype","cid":A},"success":function(D){if(D!=null){var E=+D.ret,C=common.getMsgByRet(E);if(C){loginWin.alert("<center>"+C+"</center>");return}}showmsg(true,$("#app_class_main"),"");$.each(B,function(){$(this).children().remove()});$.each(D,function(G,F){B.append("<option value="+F.cid+">"+F.cname+"</option>")});B.css("display","inline-block")}})}else{$.each(B,function(){$(this).children().remove()});B.css("display","none");showmsg(false,$("#app_class_main"),"应用分类不能为空")}});var submitCallback=function(C){var D=+(C.code||C.error),B=common.getMsgByRet(D);loginWin.close();if(B){loginWin.alert("<center>"+B+"</center>");return}if(D==0){if(loginWin){loginWin.show({"title":"更新"+OPEN_VALIDATOR.apptypeName+"信息","width":410,"height":125,"text":'<center><br/><label class="icon_ok"></label> &nbsp; '+OPEN_VALIDATOR.apptypeName+"信息更新成功<br/></center>"});setTimeout(function(){window.location.href=window.location.href},2000)}}else{var A="";if(D>100&&D<200){A="图片不合法"}else{if(D>200&&D<300){A="参数非法"}else{A="未知原因"}}if(loginWin){loginWin.show({"title":"更新"+OPEN_VALIDATOR.apptypeName+"信息","width":410,"height":185,"text":'<center><br/><label class="icon_alert"></label> &nbsp; '+OPEN_VALIDATOR.apptypeName+"信息更新失败，原因&nbsp;<strong>"+A+'</strong><br/><input type="button" class="devSubmit closeBtn" value="确定"/></center>'});loginWin.contentarea.find(".closeBtn").bind("click",function(){loginWin.close()})}}};