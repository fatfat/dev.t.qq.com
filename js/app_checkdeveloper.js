var OPEN_VALIDATOR;OPEN_VALIDATOR={checkip:function(c){var a=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;var b=c.match(a);if(b===null){return"非法的IP地址段！"}else{return true}},isempty:function(){return true},mobilenum:function(a,b){a=a.replace(/\s/g,"");b.val(a);if(new RegExp(/[^\d]/g).test(a)){return"你填写的##含有非法字符"}if(a.length==11){if(new RegExp(/^1(?:3|5|8)\d{9}$/).test(a)){return true}else{return"仅限中国境内##"}}else{return"请填写11位##"}},tname:function(a){if(a&&!(/^[a-zA-Z][a-zA-Z0-9_\-]{3,19}$/g.test(a))){return"微博帐号输入有误"}return true},telnum:function(a,b){a=a.replace(/\s/g,"");b.val(a);if(new RegExp(/^([0-9]|[-])+$/g).test(a)){return true}else{return"你填写的##含有非法字符"}},passport:function(a,c){a=a.replace(/\s/g,"");c.val(a);var b=a.match(/[^0-9a-zA-Z]+/g);if(a&&b){return"你填写的##含有非法字符"}if(new RegExp(/^[0-9a-zA-Z]+$/).test(a)){var d=c.attr("data-only");if(d){if(d==="true"){return true}else{return"该##已被注册"}}else{var e=c.attr("data-default");if(e){if(a==e){return true}else{return 1}}else{return 1}}}},cardnum_new:function(a,c){a=a.replace(/\s/g,"");c.val(a);var b=a.match(/[^0-9xX]+/g);if(a&&b){return"你填写的##含有非法字符"}if(a.length==18){if(new RegExp(/^[0-9xX]{18}$/).test(a)){var d=c.attr("data-only");if(d){if(d==="true"){return true}else{return"该##已被注册"}}else{var e=c.attr("data-default");if(e){if(a==e){return true}else{return 1}}else{return 1}}}}else{return"请填写18位身份证号码"}},cardnumCheck:function(a,c){var f=c.attr("data-error"),e=c.attr("data-default"),b=c.attr("data-rule"),d="/pipes/interfaceserver?action=common_query&business_type=ajax_checkuserid&userid="+encodeURIComponent(a);if(e!=a){showmsg(1,c,"正在验证"+f);$.ajax({type:"get",dataType:"json",url:d,success:function(h){var k=c.attr("data-working")|0,g=+h.code,j=common.getMsgByRet(g);if(j){c.attr("data-only",false);showmsg(false,c,j);c.removeAttr("data-working");return}if(g===0){c.attr("data-only",true);showmsg(true,c,"");if(k==2){setTimeout(function(){$("form input[type='submit']").trigger("click")},500)}c.removeAttr("data-working")}else{c.attr("data-only",false);c.attr("error-flag",0);showmsg(false,c,"该"+f+"已被注册");c.removeAttr("data-working");if(k==2){loginWin.alert("<center>该"+f+"已被注册</center>")}return false}},error:function(){c.attr("data-only","false");setTimeout(function(){showmsg(false,c,"验证失败！请检查网络")},100);return false}});return true}else{c.attr("data-only","true");c.removeAttr("data-working");return true}},link:function(a){var c="^((news|telnet|nttp|file|http|ftp|https)://)(([-A-Za-z0-9_]+(\\.[-A-Za-z0-9_]+)*(\\.[-A-Za-z]{2,6}))|([0-9]{1,3}(\\.[0-9]{1,3}){3}))(:[0-9]*)?(/[-A-Za-z0-9_$\\.+!*(),;:@&=?/~#%']*)*";var b=new RegExp(c);if(/["'<>]/g.test(a)){return"##不能含有单引号，双引号，尖括号"}else{if(b.test(a)){return true}else{return"##格式错误"}}},email:function(a){if(new RegExp(/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/).test(a)){return true}else{return"email格式错误"}},appdes:function(a,b){if(a.length<=300){return true}else{return"不能超过300个字符"}},appname_only:true,companyname:function(a,b){a=a.replace(/(^\s+)|(\s+$)/g,"");b.val(a);if(new RegExp(/^[^<>'"]+$/).test(a)){return true}else{return"##格式错误"}},complicensenum:function(a,c){a=a.replace(/\s/g,"");c.val(a);var b=a.match(/[^0-9\-]+/g);if(a&&b){return"你填写的##含有非法字符"}if(a.length>=8&&a.length<=20){if(new RegExp(/^[0-9]([0-9]|-(?!-)){6,18}[0-9]$/).test(a)){var d=c.attr("data-only");if(d){if(d==="true"){return true}else{return"该##已被注册"}}else{var e=c.attr("data-default");if(e){if(a==e){return true}else{return 1}}else{return 1}}}else{return"##格式错误"}}else{return"请填写8-20位##"}},complicensenumCheck:function(a,c){var f=c.attr("data-error"),e=c.attr("data-default"),b=c.attr("data-rule"),d="/pipes/interfaceserver?action=common_query&business_type=checkcomid&comid="+encodeURIComponent(a);if(e!=a){showmsg(1,c,"正在验证"+f);$.ajax({type:"get",dataType:"json",url:d,success:function(h){var k=c.attr("data-working")|0,g=+h.error,j=common.getMsgByRet(g);if(j){c.attr("data-only",false);showmsg(false,c,j);c.removeAttr("data-working");return}if(g===0){c.attr("data-only",true);showmsg(true,c,"");if(k==2){setTimeout(function(){$("form input[type='submit']").trigger("click")},500)}c.removeAttr("data-working")}else{c.attr("data-only",false);c.attr("error-flag",0);showmsg(false,c,"该"+f+"已被注册");c.removeAttr("data-working");if(k==2){loginWin.alert("<center>该"+f+"已被注册</center>")}return false}},error:function(){c.attr("data-only","false");setTimeout(function(){showmsg(false,c,"验证失败！请检查网络")},100);return false}});return true}else{c.attr("data-only","true");c.removeAttr("data-working");return true}},companyprovince:function(a,b){return true},comaddress:function(a,b){a=a.replace(/(^\s+)|(\s+$)/g,"");b.val(a);if(a.length<=100){if(new RegExp(/^[^<>'"]+$/).test(a)){return true}else{return"你填写的##含有非法字符"}}if(a.length>100){return"##不能超过100个字符"}},comperson:function(a,c){a=a.replace(/(^\s+)|(\s+$)/g,"");c.val(a);var b=/^[a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D][a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D\s]*$/,d=a.match(b);if(a&&d){return true}else{return"##含有非法字符"}},applink:function(a){if(a){return OPEN_VALIDATOR.link(a)}else{return true}}};$("form input[type='text'],form textarea").blur(function(){var b;var a;var c;var e;var d;b=$(this);a=b.val();c=b.attr("data-rule");e=b.attr("data-error");if((/^link|applink$/.test(c))&&a.length>0&&a.search(/http[s]?:\/\//)==-1){a="http://"+a;b.val(a)}if(OPEN_VALIDATOR.hasOwnProperty(c)&&c){if(!$.trim(a)&&c!="link"&&c!="applink"&&c!="companycity"){e+="不能为空";d=false}else{var f=OPEN_VALIDATOR[c](a,b);if(f==undefined){d=false;e=""}else{if(f===true){d=true}else{if(f===1){return}else{d=false;e=f.replace("##",e)}}}}if(c!="companyprovince"){showmsg(d,b,e)}else{if(c=="companyprovince"&&d==true){showmsgforselect(d,b,e)}}}});$("form input[type='checkbox']").click(function(){var a=$(this).attr("name"),b=$(this).attr("data-rule");if(b=="isempty"){if($(this).parent().find("input[type='checkbox']:checked").size()==0){showmsg(false,$(this),"请至少选择一项")}else{showmsg(true,$(this),"")}}});$("form input[type='submit']").click(function(){var h=this.form,f=$(h).find("input[data-working]");if(f.size()>0){f.attr("data-working",2);return false}var g=$.trim($(this).attr("data-rule"));if(g=="formauto"){var b,a,c,j,e=true,k="";if(!OPEN_VALIDATOR.appname_only){a="此应用名称已被注册";loginWin.alert("<center>"+a+"</center>");return false}$("form input[type='text'],form textarea").each(function(){c=$(this).attr("data-rule");j=$(this).val();a=$(this).attr("data-error");if(OPEN_VALIDATOR.hasOwnProperty(c)&&c){if(!$.trim(j)&&c!="tname"&&c!="appdes"&&c!="applink"&&c!="companycity"){a+="不能为空";b=false}else{var l=OPEN_VALIDATOR[c](j,$(this));if(l===true){b=true}else{if(l===1){return}else{b=false;a=l.replace("##",a)}}}if(e&&!b){loginWin.alert("<center>"+a+"</center>")}e=e&&b;if(c!="companyprovince"){showmsg(b,$(this),a)}else{showmsgforselect(b,$(this),a)}}else{}});if(!e){return e}var d=$("input[name='user_agree']").attr("checked");if(d===undefined){if(e){$("form").submit()}else{return false}}else{if(d==true){if(e){$("form").submit()}else{return false}}else{alert("您必须同意我们的服务协议才能继续");return false}}}return false});$("input[data-rule='link']").keydown(function(a){if(a.keyCode==13){return false}});$("form").keydown(function(a){if(a.keyCode==13){$(this).find("input[type='submit']").trigger("click");return false}});$("form input[type='reset']").click(function(){$(".form_input").next(".errorTip").remove();$(".form_input").next(".currectTip").remove()});function getlen(c){var a=0;for(var b=0;b<c.length;b++){if(c.charCodeAt(b)>255){a+=2}else{a++}}return a}function showmsg(c,d,a){var b;if(!c){b=' <span class="tip tip_err"><span class="tip_icon"></span>'+a+"</span>"}else{if(true===c){b=' <span class="tip tip_ok"><span class="tip_icon"></span></span>'}else{if(1===c){b=' <span class="tip tip_waiting"><span class="tip_icon"></span>'+a+"</span>"}else{if(2===c){b=' <span class="tip">'+a+"</span>"}}}}if(d.parent(".form_input").size()){d.parent(".form_input").parent().find(".tip").remove();d.parent(".form_input").after(b);d.parent(".form_input").parent().find(".inputdes").first().hide()}else{d.parent().find(".tip").remove();d.parent().append(b)}}function showmsgforselect(c,d,e){var b;if(!c){b=' <span class="tip tip_err"><span class="tip_icon"></span>'+e+"</span>"}else{if(true===c){b=' <span class="tip tip_ok"><span class="tip_icon"></span></span>'}}if(d.parent(".form_select").next(".form_select").size()){var a=d.parent(".form_select").next(".form_select")}else{var a=d.parent(".form_select")}a.parent().find(".tip").remove();a.after(b);a.parent().find(".inputdes").first().hide()}$("form input[data-rule='complicensenum'],form input[data-rule='cardnum_new'],form input[data-rule='passport']").change(function(){var c=$(this),b=c.attr("data-rule"),e=c.val().replace(/\s/g,"");var d={complicensenum:{reg:/^[0-9]([0-9]|-(?!-)){6,18}[0-9]$/,check:"complicensenumCheck"},cardnum_new:{reg:/^[0-9xX]{18}$/,check:"cardnumCheck"},passport:{reg:/^[0-9a-zA-Z]+$/,check:"cardnumCheck"}};for(var a in d){if(b==a){if(d[a]["reg"].test(e)){c.removeAttr("data-only");c.attr("data-working",1);OPEN_VALIDATOR[d[a]["check"]](e,c)}else{c.removeAttr("data-only")}break}}});var SELECTADDR={initAddr:function(){if(!window.LOCATION){return}LOCATION[1][81][1000]={n:"其它"};LOCATION[1][82][1000]={n:"其它"};LOCATION[1][1000]={n:"其它"};LOCATION[1][1000][1000]={n:"其它"};var a=[];for(var b in LOCATION[1]){("n"!=b)&&a.push('<li _value="'+b+'">'+LOCATION[1][b].n+"</li>")}$(".form_select_province").html(a.join("")).find("li:eq(0)").addClass("active")},bindEvents:function(e){if(!window.LOCATION){return}var a=$(e).parent(".form_select"),d=a.find(".form_select_icon"),c=a.find(".form_select_options"),b=0;e.attr("readonly","true").click(function(){e.trigger("focus")}).focus(function(){if(e.attr("data-rule")=="companycity"&&e.attr("_value")=="-1"){c.hide();loginWin.alert("<center>请先选择省份/直辖市</center>")}else{c.show()}}).bind("keydown",function(j){var f=c.find("li.active"),g=f.index();b=c.find("li").size();if(j.keyCode===9){return true}if(!c.is(":visible")){$(this).trigger("focus");return false}switch(j.keyCode){case 40:if(g+1<b){var h=c.find("li:eq("+(++g)+")");h.trigger("mouseover");if(h[0].offsetTop-c[0].scrollTop>=c.height()){c[0].scrollTop+=h.height()}}break;case 38:if(g>0){var h=c.find("li:eq("+(--g)+")");h.trigger("mouseover");if(h[0].offsetTop<c[0].scrollTop){c[0].scrollTop-=h.height()}}break;case 13:f.trigger("click");c.hide();break}return false});d.click(function(){e.trigger("focus")});$("body").bind("click",function(g){if(c.is(":visible")){if($.contains(a[0],g.target)){return}c.hide();if(e.attr("data-rule")=="companyprovince"&&e.attr("_value")=="-1"){var f=e.attr("data-error")+"不能为空";showmsgforselect(false,e,f)}}return})}};$(document).ready(function(){SELECTADDR.initAddr();$(".form_select input").each(function(){SELECTADDR.bindEvents($(this))});if(!window.LOCATION){return}$(".form_select_province").find("li").click(function(a){var j=[],b=$(this).attr("_value"),f=$(this).parent("ul").parent(".form_select"),k=f.next(".form_select"),h=f.find(".form_select_options"),d=f.find("input"),c=k.find("input"),e={};i=0;for(var g in LOCATION[1][b]){if("n"!=g){j.push('<li _value="'+g+'">'+LOCATION[1][b][g].n+"</li>");i++;if(1==i){e.n=LOCATION[1][b][g].n;e.value=g}}}$(".form_select_city").html(j.join("")).find("li:eq(0)").addClass("active");d.val($(this).html()).attr("_value",$(this).attr("_value")).trigger("change");c.val(e.n).attr("_value",e.value).trigger("change");if(typeof(a.button)!="undefined"){d.trigger("blur")}h.hide()});$(".form_select_city").find("li").live("click",function(c){var b=$(this).parent("ul").parent(".form_select"),a=b.find(".form_select_options"),d=b.find("input");d.val($(this).html()).attr("_value",$(this).attr("_value")).trigger("change");showmsgforselect(true,d,"");if(typeof(c.button)!="undefined"){d.trigger("blur")}a.hide()});$(".form_select_options").find("li").live("mouseover",function(){$(this).parent().find("li").removeClass("active");$(this).addClass("active")});$(".form_select_userAuth").find("li").click(function(d){var f=$(this).parent(".form_select_options").parent(".form_select"),c=f.find(".form_select_options"),e=f.find("input"),a=f.siblings(".form_div").find(".form_input").find("input");e.val($(this).html()).attr("_value",$(this).attr("_value")).trigger("change");if(e.attr("_value")==="1"){a.attr("placeholder","身份证号码").attr("data-rule","cardnum_new").attr("data-error","身份证号码").trigger("change")}else{if(e.attr("_value")==="0"){a.attr("placeholder","护照号码").attr("data-rule","passport").attr("data-error","护照号码").trigger("change")}}if(e.attr("data-default")==e.attr("_value")&&a.attr("data-default")==a.val()){}else{a.val("").trigger("change");var b=a.parent(".form_input").parent().find(".tip");b.size()>0&&b.remove()}a.trigger("blur");if(typeof(d.button)!="undefined"){e.trigger("blur")}c.hide()})});var need_post=false;$(function(){$("input#devSubmit").click(function(){if($(".tip_err").length>0){return}if(!need_post){location.href=NextUrl;return}var a=$(this.form);var b={action:"common_query",business_type:"ajaxsavecheckdeverloper",appid:global_obj.data.app?global_obj.data.app.app_id:global_obj.data.comp.comp_id,need_post:need_post,user_name:a.find("input[name='user_name']").val(),user_phone:a.find("input[name='user_phone']").val(),company_province:a.find("input[name='company_province']").attr("_value"),company_city:a.find("input[name='company_city']").attr("_value"),user_address:a.find("input[name='user_address']").val(),user_website:a.find("input[name='user_website']").val()};if(2==a.find("input[name='user_type']").val()){b.user_company=a.find("input[name='user_company']").val();b.user_tel=a.find("input[name='user_tel']").val();b.user_business_code=a.find("input[name='user_business_code']").val()}else{b.user_id_type=a.find("input[name='user_id_type']").attr("_value");b.user_id_card_num=a.find("input[name='user_id_card_num']").val()}$.ajax({type:"POST",url:PostUrl,dataType:"json",data:b,success:function(d){var c=+(d.code),e=common.getMsgByRet(c);if(e){loginWin.alert("<center>"+e+"</center>");return}if(c===0){location.href=NextUrl}else{loginWin.alert("<center>数据提交失败，请稍候再试</center>")}}})});$("form#appform_user input").change(function(){need_post=1})});