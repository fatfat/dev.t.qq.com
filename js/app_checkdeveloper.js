var OPEN_VALIDATOR;OPEN_VALIDATOR={checkip:function(B){var A=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;var C=B.match(A);if(C===null){return"非法的IP地址段！"}else{return true}},isempty:function(){return true},mobilenum:function(A,B){A=A.replace(/\s/g,"");B.val(A);if(new RegExp(/[^\d]/g).test(A)){return"你填写的##含有非法字符"}if(A.length==11){if(new RegExp(/^1(?:3|5|8)\d{9}$/).test(A)){return true}else{return"仅限中国境内##"}}else{return"请填写11位##"}},tname:function(A){if(A&&!(/^[a-zA-Z][a-zA-Z0-9_\-]{3,19}$/g.test(A))){return"微博帐号输入有误"}return true},telnum:function(A,B){A=A.replace(/\s/g,"");B.val(A);if(new RegExp(/^([0-9]|[-])+$/g).test(A)){return true}else{return"你填写的##含有非法字符"}},passport:function(A,D){A=A.replace(/\s/g,"");D.val(A);var E=A.match(/[^0-9a-zA-Z]+/g);if(A&&E){return"你填写的##含有非法字符"}if(new RegExp(/^[0-9a-zA-Z]+$/).test(A)){var C=D.attr("data-only");if(C){if(C==="true"){return true}else{return"该##已被注册"}}else{var B=D.attr("data-default");if(B){if(A==B){return true}else{return 1}}else{return 1}}}},cardnum_new:function(A,D){A=A.replace(/\s/g,"");D.val(A);var E=A.match(/[^0-9xX]+/g);if(A&&E){return"你填写的##含有非法字符"}if(A.length==18){if(new RegExp(/^[0-9xX]{18}$/).test(A)){var C=D.attr("data-only");if(C){if(C==="true"){return true}else{return"该##已被注册"}}else{var B=D.attr("data-default");if(B){if(A==B){return true}else{return 1}}else{return 1}}}}else{return"请填写18位身份证号码"}},cardnumCheck:function(A,E){var B=E.attr("data-error"),C=E.attr("data-default"),F=E.attr("data-rule"),D="/pipes/interfaceserver?action=common_query&business_type=ajax_checkuserid&userid="+encodeURIComponent(A);if(C!=A){showmsg(1,E,"正在验证"+B);$.ajax({"type":"get","dataType":"json","url":D,"success":function(I){var G=E.attr("data-working")|0,J=+I.code,H=common.getMsgByRet(J);if(H){E.attr("data-only",false);showmsg(false,E,H);E.removeAttr("data-working");return}if(J===0){E.attr("data-only",true);showmsg(true,E,"");if(G==2){setTimeout(function(){$("form input[type='submit']").trigger("click")},500)}E.removeAttr("data-working")}else{E.attr("data-only",false);E.attr("error-flag",0);showmsg(false,E,"该"+B+"已被注册");E.removeAttr("data-working");if(G==2){loginWin.alert("<center>该"+B+"已被注册</center>")}return false}},"error":function(){E.attr("data-only","false");setTimeout(function(){showmsg(false,E,"验证失败！请检查网络")},100);return false}});return true}else{E.attr("data-only","true");E.removeAttr("data-working");return true}},link:function(A){var B="^((news|telnet|nttp|file|http|ftp|https)://)(([-A-Za-z0-9_]+(\\.[-A-Za-z0-9_]+)*(\\.[-A-Za-z]{2,6}))|([0-9]{1,3}(\\.[0-9]{1,3}){3}))(:[0-9]*)?(/[-A-Za-z0-9_$\\.+!*(),;:@&=?/~#%']*)*";var C=new RegExp(B);if(/["'<>]/g.test(A)){return"##不能含有单引号，双引号，尖括号"}else{if(C.test(A)){return true}else{return"##格式错误"}}},email:function(A){if(new RegExp(/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/).test(A)){return true}else{return"email格式错误"}},appdes:function(A,B){if(A.length<=300){return true}else{return"不能超过300个字符"}},appname_only:true,companyname:function(A,B){A=A.replace(/(^\s+)|(\s+$)/g,"");B.val(A);if(new RegExp(/^[^<>'"]+$/).test(A)){return true}else{return"##格式错误"}},complicensenum:function(A,D){A=A.replace(/\s/g,"");D.val(A);var E=A.match(/[^0-9\-]+/g);if(A&&E){return"你填写的##含有非法字符"}if(A.length>=8&&A.length<=20){if(new RegExp(/^[0-9]([0-9]|-(?!-)){6,18}[0-9]$/).test(A)){var C=D.attr("data-only");if(C){if(C==="true"){return true}else{return"该##已被注册"}}else{var B=D.attr("data-default");if(B){if(A==B){return true}else{return 1}}else{return 1}}}else{return"##格式错误"}}else{return"请填写8-20位##"}},complicensenumCheck:function(A,E){var B=E.attr("data-error"),C=E.attr("data-default"),F=E.attr("data-rule"),D="/pipes/interfaceserver?action=common_query&business_type=checkcomid&comid="+encodeURIComponent(A);if(C!=A){showmsg(1,E,"正在验证"+B);$.ajax({"type":"get","dataType":"json","url":D,"success":function(I){var G=E.attr("data-working")|0,J=+I.error,H=common.getMsgByRet(J);if(H){E.attr("data-only",false);showmsg(false,E,H);E.removeAttr("data-working");return}if(J===0){E.attr("data-only",true);showmsg(true,E,"");if(G==2){setTimeout(function(){$("form input[type='submit']").trigger("click")},500)}E.removeAttr("data-working")}else{E.attr("data-only",false);E.attr("error-flag",0);showmsg(false,E,"该"+B+"已被注册");E.removeAttr("data-working");if(G==2){loginWin.alert("<center>该"+B+"已被注册</center>")}return false}},"error":function(){E.attr("data-only","false");setTimeout(function(){showmsg(false,E,"验证失败！请检查网络")},100);return false}});return true}else{E.attr("data-only","true");E.removeAttr("data-working");return true}},companyprovince:function(A,B){return true},comaddress:function(A,B){A=A.replace(/(^\s+)|(\s+$)/g,"");B.val(A);if(A.length<=100){if(new RegExp(/^[^<>'"]+$/).test(A)){return true}else{return"你填写的##含有非法字符"}}if(A.length>100){return"##不能超过100个字符"}},comperson:function(A,C){A=A.replace(/(^\s+)|(\s+$)/g,"");C.val(A);var D=/^[a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D][a-zA-Z\u4E00-\u9FA5\uF900-\uFA2D\s]*$/,B=A.match(D);if(A&&B){return true}else{return"##含有非法字符"}},applink:function(A){if(A){return OPEN_VALIDATOR.link(A)}else{return true}}};$("form input[type='text'],form textarea").blur(function(){var F;var A;var E;var C;var D;F=$(this);A=F.val();E=F.attr("data-rule");C=F.attr("data-error");if((/^link|applink$/.test(E))&&A.length>0&&A.search(/http[s]?:\/\//)==-1){A="http://"+A;F.val(A)}if(OPEN_VALIDATOR.hasOwnProperty(E)&&E){if(!$.trim(A)&&E!="link"&&E!="applink"&&E!="companycity"){C+="不能为空";D=false}else{var B=OPEN_VALIDATOR[E](A,F);if(B==undefined){D=false;C=""}else{if(B===true){D=true}else{if(B===1){return}else{D=false;C=B.replace("##",C)}}}}if(E!="companyprovince"){showmsg(D,F,C)}else{if(E=="companyprovince"&&D==true){showmsgforselect(D,F,C)}}}});$("form input[type='checkbox']").click(function(){var A=$(this).attr("name"),B=$(this).attr("data-rule");if(B=="isempty"){if($(this).parent().find("input[type='checkbox']:checked").size()==0){showmsg(false,$(this),"请至少选择一项")}else{showmsg(true,$(this),"")}}});$("form input[type='submit']").click(function(){var G=this.form,I=$(G).find("input[data-working]");if(I.size()>0){I.attr("data-working",2);return false}var H=$.trim($(this).attr("data-rule"));if(H=="formauto"){var C,D,B,F,J=true,E="";if(!OPEN_VALIDATOR.appname_only){D="此应用名称已被注册";loginWin.alert("<center>"+D+"</center>");return false}$("form input[type='text'],form textarea").each(function(){B=$(this).attr("data-rule");F=$(this).val();D=$(this).attr("data-error");if(OPEN_VALIDATOR.hasOwnProperty(B)&&B){if(!$.trim(F)&&B!="tname"&&B!="appdes"&&B!="applink"&&B!="companycity"){D+="不能为空";C=false}else{var K=OPEN_VALIDATOR[B](F,$(this));if(K===true){C=true}else{if(K===1){return}else{C=false;D=K.replace("##",D)}}}if(J&&!C){loginWin.alert("<center>"+D+"</center>")}J=J&&C;if(B!="companyprovince"){showmsg(C,$(this),D)}else{showmsgforselect(C,$(this),D)}}else{}});if(!J){return J}var A=$("input[name='user_agree']").attr("checked");if(A===undefined){if(J){$("form").submit()}else{return false}}else{if(A==true){if(J){$("form").submit()}else{return false}}else{alert("您必须同意我们的服务协议才能继续");return false}}}return false});$("input[data-rule='link']").keydown(function(A){if(A.keyCode==13){return false}});$("form").keydown(function(A){if(A.keyCode==13){$(this).find("input[type='submit']").trigger("click");return false}});$("form input[type='reset']").click(function(){$(".form_input").next(".errorTip").remove();$(".form_input").next(".currectTip").remove()});function getlen(B){var A=0;for(var C=0;C<B.length;C++){if(B.charCodeAt(C)>255){A+=2}else{A++}}return A}function showmsg(C,B,A){var D;if(!C){D=' <span class="tip tip_err"><span class="tip_icon"></span>'+A+"</span>"}else{if(true===C){D=' <span class="tip tip_ok"><span class="tip_icon"></span></span>'}else{if(1===C){D=' <span class="tip tip_waiting"><span class="tip_icon"></span>'+A+"</span>"}else{if(2===C){D=' <span class="tip">'+A+"</span>"}}}}if(B.parent(".form_input").size()){B.parent(".form_input").parent().find(".tip").remove();B.parent(".form_input").after(D);B.parent(".form_input").parent().find(".inputdes").first().hide()}else{B.parent().find(".tip").remove();B.parent().append(D)}}function showmsgforselect(D,C,B){var E;if(!D){E=' <span class="tip tip_err"><span class="tip_icon"></span>'+B+"</span>"}else{if(true===D){E=' <span class="tip tip_ok"><span class="tip_icon"></span></span>'}}if(C.parent(".form_select").next(".form_select").size()){var A=C.parent(".form_select").next(".form_select")}else{var A=C.parent(".form_select")}A.parent().find(".tip").remove();A.after(E);A.parent().find(".inputdes").first().hide()}$("form input[data-rule='complicensenum'],form input[data-rule='cardnum_new'],form input[data-rule='passport']").change(function(){var D=$(this),E=D.attr("data-rule"),B=D.val().replace(/\s/g,"");var C={"complicensenum":{"reg":/^[0-9]([0-9]|-(?!-)){6,18}[0-9]$/,"check":"complicensenumCheck"},"cardnum_new":{"reg":/^[0-9xX]{18}$/,"check":"cardnumCheck"},"passport":{"reg":/^[0-9a-zA-Z]+$/,"check":"cardnumCheck"}};for(var A in C){if(E==A){if(C[A]["reg"].test(B)){D.removeAttr("data-only");D.attr("data-working",1);OPEN_VALIDATOR[C[A]["check"]](B,D)}else{D.removeAttr("data-only")}break}}});var SELECTADDR={initAddr:function(){if(!window.LOCATION){return}LOCATION[1][81][1000]={n:"其它"};LOCATION[1][82][1000]={n:"其它"};LOCATION[1][1000]={n:"其它"};LOCATION[1][1000][1000]={n:"其它"};var A=[];for(var B in LOCATION[1]){("n"!=B)&&A.push('<li _value="'+B+'">'+LOCATION[1][B].n+"</li>")}$(".form_select_province").html(A.join("")).find("li:eq(0)").addClass("active")},bindEvents:function(B){if(!window.LOCATION){return}var A=$(B).parent(".form_select"),C=A.find(".form_select_icon"),D=A.find(".form_select_options"),E=0;B.attr("readonly","true").click(function(){B.trigger("focus")}).focus(function(){if(B.attr("data-rule")=="companycity"&&B.attr("_value")=="-1"){D.hide();loginWin.alert("<center>请先选择省份/直辖市</center>")}else{D.show()}}).bind("keydown",function(F){var I=D.find("li.active"),H=I.index();E=D.find("li").size();if(F.keyCode===9){return true}if(!D.is(":visible")){$(this).trigger("focus");return false}switch(F.keyCode){case 40:if(H+1<E){var G=D.find("li:eq("+(++H)+")");G.trigger("mouseover");if(G[0].offsetTop-D[0].scrollTop>=D.height()){D[0].scrollTop+=G.height()}}break;case 38:if(H>0){var G=D.find("li:eq("+(--H)+")");G.trigger("mouseover");if(G[0].offsetTop<D[0].scrollTop){D[0].scrollTop-=G.height()}}break;case 13:I.trigger("click");D.hide();break}return false});C.click(function(){B.trigger("focus")});$("body").bind("click",function(F){if(D.is(":visible")){if($.contains(A[0],F.target)){return}D.hide();if(B.attr("data-rule")=="companyprovince"&&B.attr("_value")=="-1"){var G=B.attr("data-error")+"不能为空";showmsgforselect(false,B,G)}}return})}};$(document).ready(function(){SELECTADDR.initAddr();$(".form_select input").each(function(){SELECTADDR.bindEvents($(this))});if(!window.LOCATION){return}$(".form_select_province").find("li").click(function(D){var F=[],C=$(this).attr("_value"),I=$(this).parent("ul").parent(".form_select"),E=I.next(".form_select"),G=I.find(".form_select_options"),A=I.find("input"),B=E.find("input"),J={};i=0;for(var H in LOCATION[1][C]){if("n"!=H){F.push('<li _value="'+H+'">'+LOCATION[1][C][H].n+"</li>");i++;if(1==i){J.n=LOCATION[1][C][H].n;J.value=H}}}$(".form_select_city").html(F.join("")).find("li:eq(0)").addClass("active");A.val($(this).html()).attr("_value",$(this).attr("_value")).trigger("change");B.val(J.n).attr("_value",J.value).trigger("change");if(typeof(D.button)!="undefined"){A.trigger("blur")}G.hide()});$(".form_select_city").find("li").live("click",function(C){var D=$(this).parent("ul").parent(".form_select"),A=D.find(".form_select_options"),B=D.find("input");B.val($(this).html()).attr("_value",$(this).attr("_value")).trigger("change");showmsgforselect(true,B,"");if(typeof(C.button)!="undefined"){B.trigger("blur")}A.hide()});$(".form_select_options").find("li").live("mouseover",function(){$(this).parent().find("li").removeClass("active");$(this).addClass("active")});$(".form_select_userAuth").find("li").click(function(D){var B=$(this).parent(".form_select_options").parent(".form_select"),E=B.find(".form_select_options"),C=B.find("input"),A=B.siblings(".form_div").find(".form_input").find("input");C.val($(this).html()).attr("_value",$(this).attr("_value")).trigger("change");if(C.attr("_value")==="1"){A.attr("placeholder","身份证号码").attr("data-rule","cardnum_new").attr("data-error","身份证号码").trigger("change")}else{if(C.attr("_value")==="0"){A.attr("placeholder","护照号码").attr("data-rule","passport").attr("data-error","护照号码").trigger("change")}}if(C.attr("data-default")==C.attr("_value")&&A.attr("data-default")==A.val()){}else{A.val("").trigger("change");var F=A.parent(".form_input").parent().find(".tip");F.size()>0&&F.remove()}A.trigger("blur");if(typeof(D.button)!="undefined"){C.trigger("blur")}E.hide()})});var need_post=false;$(function(){$("input#devSubmit").click(function(){if($(".tip_err").length>0){return}if(!need_post){location.href=NextUrl;return}var A=$(this.form);var B={"action":"common_query","business_type":"ajaxsavecheckdeverloper","appid":global_obj.data.app?global_obj.data.app.app_id:global_obj.data.comp.comp_id,"need_post":need_post,"user_name":A.find("input[name='user_name']").val(),"user_phone":A.find("input[name='user_phone']").val(),"company_province":A.find("input[name='company_province']").attr("_value"),"company_city":A.find("input[name='company_city']").attr("_value"),"user_address":A.find("input[name='user_address']").val(),"user_website":A.find("input[name='user_website']").val()};if(2==A.find("input[name='user_type']").val()){B["user_company"]=A.find("input[name='user_company']").val();B["user_tel"]=A.find("input[name='user_tel']").val();B["user_business_code"]=A.find("input[name='user_business_code']").val()}else{B["user_id_type"]=A.find("input[name='user_id_type']").attr("_value");B["user_id_card_num"]=A.find("input[name='user_id_card_num']").val()}$.ajax({type:"POST",url:PostUrl,dataType:"json",data:B,success:function(D){var E=+(D.code),C=common.getMsgByRet(E);if(C){loginWin.alert("<center>"+C+"</center>");return}if(E===0){location.href=NextUrl}else{loginWin.alert("<center>数据提交失败，请稍候再试</center>")}}})});$("form#appform_user input").change(function(){need_post=1})});