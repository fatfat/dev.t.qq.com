var OPEN_VALIDATOR;OPEN_VALIDATOR={appweibo:function(e,b){var d=b.attr("data-error");e=e.replace(/\s/g,"");b.val(e);if(e&&!(/^[a-zA-Z][a-zA-Z0-9_\-]{0,19}$/g.test(e))){return d+"输入有误"}var c=b.attr("data-only");if(c){if(c==="true"){return true}else{var a=+b.attr("error-flag");if(a===1){return"该"+d+"尚未通过认证"}else{if(a===0){return"该"+d+"不存在"}else{if(a===undefined){return 1}}}}}else{return 1}return true},appweiboCheck:function(a,d){var g=d.attr("data-error"),f=d.attr("data-default"),b=d.attr("data-rule"),e="/pipes/interfaceserver",c={action:"common_query",business_type:"ajax_checkvip",account:a};if(f!=a){showmsg(1,d,"正在验证"+g);$.ajax({type:"get",dataType:"json",url:e,data:c,success:function(i){var k=d.attr("data-working")|0,h=+i.ret,j=common.getMsgByRet(h);if(j){d.attr("data-only",false);showmsg(false,d,j);d.removeAttr("data-working");return}if(h===0){d.attr("data-only",true);showmsg(true,d,"");if(k==2){setTimeout(function(){$("form input[type='submit']").trigger("click")},500)}else{getPreview(i.data.head,i.data.nick,i.data.notice_type)}d.removeAttr("data-working")}else{if(h===1){d.attr("data-only",false);d.attr("error-flag",1);showmsg(false,d,"该"+g+"尚未通过认证");d.removeAttr("data-working");if(k==2){loginWin.alert("<center>该"+g+"尚未通过认证</center>")}getPreview("http://app.qlogo.cn/mbloghead/f961aa13250bb219f968","你画我猜",0);return false}else{d.attr("data-only",false);d.attr("error-flag",0);showmsg(false,d,"该"+g+"不存在");d.removeAttr("data-working");if(k==2){loginWin.alert("<center>该"+g+"不存在</center>")}getPreview("http://app.qlogo.cn/mbloghead/f961aa13250bb219f968","你画我猜",0);return false}}},error:function(){d.attr("data-only","false");setTimeout(function(){showmsg(false,d,"验证失败！请检查网络")},100);getPreview("http://app.qlogo.cn/mbloghead/f961aa13250bb219f968","你画我猜",0);return false}});return true}else{d.attr("data-only","true");d.removeAttr("data-working");return true}}};function showmsg(c,d,a){var b;if(!c){b=' <span class="tip tip_err"><span class="tip_icon"></span>'+a+"</span>"}else{if(true===c){b=' <span class="tip tip_ok"><span class="tip_icon"></span></span>'}else{if(1===c){b=' <span class="tip tip_waiting"><span class="tip_icon"></span>'+a+"</span>"}else{if(2===c){b=' <span class="tip">'+a+"</span>"}}}}if(d.parent(".form_input").size()){d.parent(".form_input").parent().find(".tip").remove();d.parent(".form_input").after(b);d.parent(".form_input").parent().find(".inputdes").first().hide()}else{d.parent().find(".tip").remove();d.parent().append(b)}if(!c){removePreview()}}$(function(){$("input[type='text']").blur(function(){var b,a,c,e,d;b=$(this);b.val($.trim(b.val()));a=b.val();c=b.attr("data-rule");e=b.attr("data-error");if(OPEN_VALIDATOR.hasOwnProperty(c)&&c){if(!$.trim(a)){e+="不能为空";d=false}else{var f=OPEN_VALIDATOR[c](a,b);if(f==undefined){d=false;e=""}else{if(f===true){d=true}else{if(f===1){return}else{d=false;e=f}}}}showmsg(d,b,e)}if(!d){getPreview("http://app.qlogo.cn/mbloghead/f961aa13250bb219f968","你画我猜",0)}});$("form input[data-rule='appweibo']").change(function(){var c=$(this),b=c.attr("data-rule"),a=c.val().replace(/\s/g,"");if(b=="appweibo"){if(/^[a-zA-Z][a-zA-Z0-9_\-]{0,19}$/g.test(a)){c.removeAttr("data-only");c.removeAttr("error-flag");c.attr("data-working",1);OPEN_VALIDATOR.appweiboCheck(a,c)}}});$("#noticeSubmit").click(function(){var h,g,a,e,b=true,f="",d=this.form,c=$(d).find("input[data-working]");if(c.size()>0){c.attr("data-working",2);return false}$(".appform input[type='text']").each(function(){a=$(this).attr("data-rule");e=$(this).val();g=$(this).attr("data-error");if(OPEN_VALIDATOR.hasOwnProperty(a)&&a){if(!$.trim(e)){g+="不能为空";h=false}else{var i=OPEN_VALIDATOR[a](e,$(this));if(i===true){h=true}else{if(i===1){return}else{h=false;g=i}}}b=b&&h;showmsg(h,$(this),g);if(h===false){loginWin.alert("<center>"+g+"</center>")}}});if(b){formSubmit()}return false});$("form").keydown(function(a){if(a.keyCode==13){}});$("form input[type='reset']").click(function(){$(".form_input").next(".errorTip").remove();$(".form_input").next(".currectTip").remove();location.href="/development/notice?appid="+global_obj.data.app.app_id})});