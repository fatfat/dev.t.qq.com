var jscolor={dir:"",bindClass:"color",binding:true,preloading:true,confirmAction:null,install:function(){if(document.readyState==="complete"){return jscolor.init()}jscolor.addEvent(window,"load",jscolor.init)},init:function(){if(jscolor.binding){jscolor.bind()}if(jscolor.preloading){jscolor.preload()}},getDir:function(){if(!jscolor.dir){var A=jscolor.detectDir();jscolor.dir=A!==false?A:"jscolor/"}return"http://mat1.gtimg.com/app/opent/images/websites/jscolor/";return jscolor.dir},detectDir:function(){var A=location.href;var D=document.getElementsByTagName("base");for(var C=0;C<D.length;C+=1){if(D[C].href){A=D[C].href}}var D=document.getElementsByTagName("script");for(var C=0;C<D.length;C+=1){if(D[C].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(D[C].src)){var E=new jscolor.URI(D[C].src);var B=E.toAbsolute(A);B.path=B.path.replace(/[^\/]+$/,"");B.query=null;B.fragment=null;return B.toString()}}return false},bind:function(){var matchClass=new RegExp("(^|\\s)("+jscolor.bindClass+")\\s*(\\{[^}]*\\})?","i");var e=document.getElementsByTagName("input");for(var i=0;i<e.length;i+=1){var m;if(!e[i].color&&e[i].className&&(m=e[i].className.match(matchClass))){var prop={};if(m[3]){try{eval("prop="+m[3])}catch(eInvalidProp){}}e[i].color=new jscolor.color(e[i],prop)}}},onConfirmChange:function(A){this.confirmAction=A},confirm:function(){if(this.confirmAction){this.confirmAction()}},preload:function(){for(var A in jscolor.imgRequire){if(jscolor.imgRequire.hasOwnProperty(A)){jscolor.loadImage(A)}}},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(A){jscolor.imgRequire[A]=true},loadImage:function(A){if(!jscolor.imgLoaded[A]){jscolor.imgLoaded[A]=new Image();jscolor.imgLoaded[A].src=jscolor.getDir()+A}},fetchElement:function(A){return typeof A==="string"?document.getElementById(A):A},addEvent:function(B,A,C){if(B.addEventListener){B.addEventListener(A,C,false)}else{if(B.attachEvent){B.attachEvent("on"+A,C)}}},fireEvent:function(B,A){if(!B){return}if(document.createEventObject){var C=document.createEventObject();B.fireEvent("on"+A,C)}else{if(document.createEvent){var C=document.createEvent("HTMLEvents");C.initEvent(A,true,true);B.dispatchEvent(C)}else{if(B["on"+A]){B["on"+A]()}}}},getElementPos:function(E){var D=E,C=E;var A=0,B=0;if(D.offsetParent){do{A+=D.offsetLeft;B+=D.offsetTop}while(D=D.offsetParent)}while((C=C.parentNode)&&C.nodeName.toUpperCase()!=="BODY"){A-=C.scrollLeft;B-=C.scrollTop}return[A,B]},getElementSize:function(A){return[A.offsetWidth,A.offsetHeight]},getMousePos:function(A){if(!A){A=window.event}if(typeof A.pageX==="number"){return[A.pageX,A.pageY]}else{if(typeof A.clientX==="number"){return[A.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,A.clientY+document.body.scrollTop+document.documentElement.scrollTop]}}},getViewPos:function(){if(typeof window.pageYOffset==="number"){return[window.pageXOffset,window.pageYOffset]}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){return[document.body.scrollLeft,document.body.scrollTop]}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){return[document.documentElement.scrollLeft,document.documentElement.scrollTop]}else{return[0,0]}}}},getViewSize:function(){if(typeof window.innerWidth==="number"){return[window.innerWidth,window.innerHeight]}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){return[document.body.clientWidth,document.body.clientHeight]}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){return[document.documentElement.clientWidth,document.documentElement.clientHeight]}else{return[0,0]}}}},URI:function(B){this.scheme=null;this.authority=null;this.path="";this.query=null;this.fragment=null;this.parse=function(D){var C=D.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);this.scheme=C[3]?C[2]:null;this.authority=C[5]?C[6]:null;this.path=C[7];this.query=C[9]?C[10]:null;this.fragment=C[12]?C[13]:null;return this};this.toString=function(){var C="";if(this.scheme!==null){C=C+this.scheme+":"}if(this.authority!==null){C=C+"//"+this.authority}if(this.path!==null){C=C+this.path}if(this.query!==null){C=C+"?"+this.query}if(this.fragment!==null){C=C+"#"+this.fragment}return C};this.toAbsolute=function(D){var D=new jscolor.URI(D);var C=this;var E=new jscolor.URI;if(D.scheme===null){return false}if(C.scheme!==null&&C.scheme.toLowerCase()===D.scheme.toLowerCase()){C.scheme=null}if(C.scheme!==null){E.scheme=C.scheme;E.authority=C.authority;E.path=A(C.path);E.query=C.query}else{if(C.authority!==null){E.authority=C.authority;E.path=A(C.path);E.query=C.query}else{if(C.path===""){E.path=D.path;if(C.query!==null){E.query=C.query}else{E.query=D.query}}else{if(C.path.substr(0,1)==="/"){E.path=A(C.path)}else{if(D.authority!==null&&D.path===""){E.path="/"+C.path}else{E.path=D.path.replace(/[^\/]+$/,"")+C.path}E.path=A(E.path)}E.query=C.query}E.authority=D.authority}E.scheme=D.scheme}E.fragment=C.fragment;return E};function A(E){var C="";while(E){if(E.substr(0,3)==="../"||E.substr(0,2)==="./"){E=E.replace(/^\.+/,"").substr(1)}else{if(E.substr(0,3)==="/./"||E==="/."){E="/"+E.substr(3)}else{if(E.substr(0,4)==="/../"||E==="/.."){E="/"+E.substr(4);C=C.replace(/\/?[^\/]*$/,"")}else{if(E==="."||E===".."){E=""}else{var D=E.match(/^\/?[^\/]*/)[0];E=E.substr(D.length);C=C+D}}}}}return C}if(B){this.parse(B)}},getNextEl:function(A,B){if(A.nextSibling.nodeName.toLowerCase()!==B){return this.getNextEl(A.nextSibling,B)}return A.nextSibling},color:function(W,G){this.required=true;this.adjust=true;this.hash=false;this.caps=true;this.valueElement=W;this.styleElement=jscolor.getNextEl(W,"div");this.hsv=[0,0,1];this.rgb=[1,1,1];this.pickerOnfocus=true;this.pickerMode="HSV";this.pickerPosition="bottom";this.pickerFace=10;this.pickerFaceColor="ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=10000;for(var F in G){if(G.hasOwnProperty(F)){this[F]=G[F]}}this.hidePicker=function(){if(B()){K();jscolor.confirm()}};this.showPicker=function(){U.importColor();if(!B()){var d=jscolor.getElementPos(W);var g=jscolor.getElementSize(W);var e=jscolor.getViewPos();var h=jscolor.getViewSize();var m=[2*this.pickerBorder+4*this.pickerInset+2*this.pickerFace+jscolor.images.pad[0]+2*jscolor.images.arrow[0]+jscolor.images.sld[0],2*this.pickerBorder+2*this.pickerInset+2*this.pickerFace+jscolor.images.pad[1]];var i,j,k;switch(this.pickerPosition.toLowerCase()){case"left":i=1;j=0;k=-1;break;case"right":i=1;j=0;k=1;break;case"top":i=0;j=1;k=-1;break;default:i=0;j=1;k=1;break}var f=(g[j]+m[j])/2;var n=[-e[i]+d[i]+m[i]>h[i]?(-e[i]+d[i]+g[i]/2>h[i]/2&&d[i]+g[i]-m[i]>=0?d[i]+g[i]-m[i]:d[i]):d[i],-e[j]+d[j]+g[j]+m[j]-f+f*k>h[j]?(-e[j]+d[j]+g[j]/2>h[j]/2&&d[j]+g[j]-f-f*k>=0?d[j]+g[j]-f-f*k:d[j]+g[j]-f+f*k):(d[j]+g[j]-f+f*k>=0?d[j]+g[j]-f+f*k:d[j]+g[j]-f-f*k)];V(n[i],n[j])}};this.importColor=function(){if(!T){this.exportColor()}else{if(!this.adjust){if(!this.fromString(T.value,L)){b.style.backgroundColor=b.jscStyle.backgroundColor;b.style.color=b.jscStyle.color;this.exportColor(L|D)}}else{if(!this.required&&/^\s*$/.test(T.value)){T.value="";b.style.backgroundColor=b.jscStyle.backgroundColor;b.style.color=b.jscStyle.color;this.exportColor(L|D)}else{if(this.fromString(T.value)){}else{this.exportColor()}}}}};this.exportColor=function(d){if(!(d&L)&&T){var c=this.toString();if(this.caps){c=c.toUpperCase()}if(this.hash){c="#"+c}T.value=c}if(!(d&D)&&b){b.style.backgroundColor="#"+this.toString();b.style.color=0.213*this.rgb[0]+0.715*this.rgb[1]+0.072*this.rgb[2]<0.5?"#FFF":"#000"}if(!(d&H)&&B()){O()}if(!(d&R)&&B()){E()}};this.fromHSV=function(e,c,d,f){e<0&&(e=0)||e>6&&(e=6);c<0&&(c=0)||c>1&&(c=1);d<0&&(d=0)||d>1&&(d=1);this.rgb=A(e===null?this.hsv[0]:(this.hsv[0]=e),c===null?this.hsv[1]:(this.hsv[1]=c),d===null?this.hsv[2]:(this.hsv[2]=d));this.exportColor(f)};this.fromRGB=function(c,h,e,f){c<0&&(c=0)||c>1&&(c=1);h<0&&(h=0)||h>1&&(h=1);e<0&&(e=0)||e>1&&(e=1);var d=C(c===null?this.rgb[0]:(this.rgb[0]=c),h===null?this.rgb[1]:(this.rgb[1]=h),e===null?this.rgb[2]:(this.rgb[2]=e));if(d[0]!==null){this.hsv[0]=d[0]}if(d[2]!==0){this.hsv[1]=d[1]}this.hsv[2]=d[2];this.exportColor(f)};this.fromString=function(d,e){var c=d.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);if(!c){return false}else{if(c[1].length===6){this.fromRGB(parseInt(c[1].substr(0,2),16)/255,parseInt(c[1].substr(2,2),16)/255,parseInt(c[1].substr(4,2),16)/255,e)}else{this.fromRGB(parseInt(c[1].charAt(0)+c[1].charAt(0),16)/255,parseInt(c[1].charAt(1)+c[1].charAt(1),16)/255,parseInt(c[1].charAt(2)+c[1].charAt(2),16)/255,e)}return true}};this.toString=function(){return((256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1))};function C(c,k,f){var d=Math.min(Math.min(c,k),f);var e=Math.max(Math.max(c,k),f);var j=e-d;if(j===0){return[null,0,e]}var i=c===d?3+(f-k)/j:(k===d?5+(c-f)/j:1+(k-c)/j);return[i===6?0:i,j/e,e]}function A(g,d,e){if(g===null){return[e,e,e]}var j=Math.floor(g);var l=j%2?g-j:1-(g-j);var c=e*(1-d);var k=e*(1-d*l);switch(j){case 6:case 0:return[e,k,c];case 1:return[k,e,c];case 2:return[c,e,k];case 3:return[c,k,e];case 4:return[k,c,e];case 5:return[e,c,k]}}function K(){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}function V(f,d){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),bottompad:document.createElement("div")};for(var c=0,k=4;c<jscolor.images.sld[1];c+=k){var g=document.createElement("div");g.style.height=k+"px";g.style.fontSize="1px";g.style.lineHeight="0";jscolor.picker.sld.appendChild(g)}jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.boxB.appendChild(jscolor.picker.box);jscolor.picker.box.appendChild(jscolor.picker.bottompad)}var h=jscolor.picker;I=[f+U.pickerBorder+U.pickerFace+U.pickerInset,d+U.pickerBorder+U.pickerFace+U.pickerInset];Y=[null,d+U.pickerBorder+U.pickerFace+U.pickerInset];h.box.onmouseup=h.box.onmouseout=function(){W.focus()};h.box.onmousedown=function(){P=true};h.box.onmousemove=function(i){J&&X(i);N&&M(i)};h.padM.onmouseup=h.padM.onmouseout=function(){if(J){J=false;jscolor.fireEvent(T,"change")}};h.padM.onmousedown=function(i){J=true;X(i)};h.sldM.onmouseup=h.sldM.onmouseout=function(){if(N){N=false;jscolor.fireEvent(T,"change")}};h.sldM.onmousedown=function(i){N=true;M(i)};h.box.style.width=4*U.pickerInset+2*U.pickerFace+jscolor.images.pad[0]+2*jscolor.images.arrow[0]+jscolor.images.sld[0]+"px";h.box.style.height=2*U.pickerInset+2*U.pickerFace+jscolor.images.pad[1]+25+"px";h.boxB.style.position="absolute";h.boxB.style.clear="both";h.boxB.style.left=f+"px";h.boxB.style.top=d+"px";h.boxB.style.zIndex=U.pickerZIndex;h.boxB.style.border=U.pickerBorder+"px solid";h.boxB.style.borderColor=U.pickerBorderColor;h.boxB.style.background=U.pickerFaceColor;h.pad.style.width=jscolor.images.pad[0]+"px";h.pad.style.height=jscolor.images.pad[1]+"px";h.padB.style.position="absolute";h.padB.style.left=U.pickerFace+"px";h.padB.style.top=U.pickerFace+"px";h.padB.style.border=U.pickerInset+"px solid";h.padB.style.borderColor=U.pickerInsetColor;h.padM.style.position="absolute";h.padM.style.left="0";h.padM.style.top="0";h.padM.style.width=U.pickerFace+2*U.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px";h.padM.style.height=h.box.style.height;h.padM.style.cursor="crosshair";h.sld.style.overflow="hidden";h.sld.style.width=jscolor.images.sld[0]+"px";h.sld.style.height=jscolor.images.sld[1]+"px";h.sldB.style.position="absolute";h.sldB.style.right=U.pickerFace+"px";h.sldB.style.top=U.pickerFace+"px";h.sldB.style.border=U.pickerInset+"px solid";h.sldB.style.borderColor=U.pickerInsetColor;h.sldM.style.position="absolute";h.sldM.style.right="0";h.sldM.style.top="0";h.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+U.pickerFace+2*U.pickerInset+"px";h.sldM.style.height=h.box.style.height;try{h.sldM.style.cursor="pointer"}catch(j){h.sldM.style.cursor="hand"}h.bottompad.style.cssText="background:transparent;width:100%;height:25px;position:absolute;left:0%;top:"+(2*U.pickerInset+2*U.pickerFace+jscolor.images.pad[1]-5)+"px;";h.bottompad.innerHTML="<button style='float:right;margin-right:8px;' onclick=\"javascript:jscolor.picker.owner.valueElement.blur();\">确定</button>";switch(Q){case 0:var e="hs.png";break;case 1:var e="hv.png";break}h.padM.style.background="url('"+jscolor.getDir()+"cross.gif') no-repeat";h.sldM.style.background="url('"+jscolor.getDir()+"arrow.gif') no-repeat";if(!h.pad.style.background){h.pad.style.background="url('"+(jscolor.getDir()+e)+"') no-repeat"}O();E();jscolor.picker.owner=U;document.getElementsByTagName("body")[0].appendChild(h.boxB)}function O(){switch(Q){case 0:var n=1;break;case 1:var n=2;break}var e=Math.round((U.hsv[0]/6)*(jscolor.images.pad[0]-1));var g=Math.round((1-U.hsv[n])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=(U.pickerFace+U.pickerInset+e-Math.floor(jscolor.images.cross[0]/2))+"px "+(U.pickerFace+U.pickerInset+g-Math.floor(jscolor.images.cross[1]/2))+"px";var d=jscolor.picker.sld.childNodes;switch(Q){case 0:var m=A(U.hsv[0],U.hsv[1],1);for(var l=0;l<d.length;l+=1){d[l].style.backgroundColor="rgb("+(m[0]*(1-l/d.length)*100)+"%,"+(m[1]*(1-l/d.length)*100)+"%,"+(m[2]*(1-l/d.length)*100)+"%)"}break;case 1:var m,j,h=[U.hsv[2],0,0];var l=Math.floor(U.hsv[0]);var k=l%2?U.hsv[0]-l:1-(U.hsv[0]-l);switch(l){case 6:case 0:m=[0,1,2];break;case 1:m=[1,0,2];break;case 2:m=[2,0,1];break;case 3:m=[2,1,0];break;case 4:m=[1,2,0];break;case 5:m=[0,2,1];break}for(var l=0;l<d.length;l+=1){j=1-1/(d.length-1)*l;h[1]=h[0]*(1-j*k);h[2]=h[0]*(1-j);d[l].style.backgroundColor="rgb("+(h[m[0]]*100)+"%,"+(h[m[1]]*100)+"%,"+(h[m[2]]*100)+"%)"}break}}function E(){switch(Q){case 0:var d=2;break;case 1:var d=1;break}var c=Math.round((1-U.hsv[d])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(U.pickerFace+U.pickerInset+c-Math.floor(jscolor.images.arrow[1]/2))+"px"}function B(){return jscolor.picker&&jscolor.picker.owner===U}function Z(){if(T===W){U.importColor()}if(U.pickerOnfocus){U.hidePicker()}}function a(){if(T!==W){U.importColor()}}function X(f){var g=jscolor.getMousePos(f);var c=g[0]-I[0];var d=g[1]-I[1];switch(Q){case 0:U.fromHSV(c*(6/(jscolor.images.pad[0]-1)),1-d/(jscolor.images.pad[1]-1),null,R);break;case 1:U.fromHSV(c*(6/(jscolor.images.pad[0]-1)),null,1-d/(jscolor.images.pad[1]-1),R);break}}function M(d){var f=jscolor.getMousePos(d);var c=f[1]-I[1];switch(Q){case 0:U.fromHSV(null,null,1-c/(jscolor.images.sld[1]-1),H);break;case 1:U.fromHSV(null,1-c/(jscolor.images.sld[1]-1),null,H);break}}var U=this;var Q=this.pickerMode.toLowerCase()==="hvs"?1:0;var P=false;var T=jscolor.fetchElement(this.valueElement),b=jscolor.fetchElement(this.styleElement);var J=false,N=false;var I,Y;var L=1<<0,D=1<<1,H=1<<2,R=1<<3;jscolor.addEvent(W,"focus",function(){if(U.pickerOnfocus){U.showPicker()}});jscolor.addEvent(W,"blur",function(){if(!P){window.setTimeout(function(){P||Z();P=false},0)}else{P=false}});if(T){var S=function(){U.fromString(T.value,L)};jscolor.addEvent(T,"keyup",S);jscolor.addEvent(T,"input",S);jscolor.addEvent(T,"blur",a);T.setAttribute("autocomplete","off")}if(b){b.jscStyle={backgroundColor:b.style.backgroundColor,color:b.style.color}}switch(Q){case 0:jscolor.requireImage("hs.png");break;case 1:jscolor.requireImage("hv.png");break}jscolor.requireImage("cross.gif");jscolor.requireImage("arrow.gif");this.importColor()}};jscolor.install();